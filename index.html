<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BioSynCare Lab - Neurosensory Stimulation Dashboard</title>
    <meta
      name="description"
      content="Neurosensory stimulation dashboard with binaural beats, isochronic tones, noise generators, and ONC ontology browser."
    />
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Ccircle cx='8' cy='8' r='8' fill='%232563eb'/%3E%3Cpath d='M4 8a4 4 0 018 0 4 4 0 11-8 0z' fill='%23a855f7' opacity='0.55'/%3E%3C/svg%3E"
    />
    <link
      rel="apple-touch-icon"
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACPElEQVR4Xu2asU4DMRCG33QGkIhOkEDMIJoE0EHYAh0gIwAFgAhagNBAm9l8rsrSTefs7M55QE7nLs1b9+6ure4Lr0n8yUxEdERERERET0Qg1YBIMAk2AQLgLmAhd2DnbYHwTIQdL6At/B5gKsgDKbjUC33hsnyJ8f0kAGQBbYrDNoBuIBf43cA64Amq4hXARrDDQS0gJA00NIA7P8goWDthbn0Us2GCBb8yQYHc5n0IQ7wHmIC4zQ9MYPAF+vYVS6nxGx7nK6XzZLk3c5t0b0Hw5ZweuOXp9T17vk+f2XdJ1EQTIJxcxel69afJqPgFmX/307ut6gMkgBu29+NCTB0TSwNdpriPrZ7tHut3EBJAAm4LmkMifAPjIbQG9MHxfB5RbG866Z+7pH4AAt8G4uO7WS9fSIkAzQBOsgB0Nbi4wQBBcibcRgwBftR9m7XtkqufVJmAAV5Ieu8ERkrdO5GRAyWnXAJbThihfX3FDTiBMg8T6wAI38LNvj0pTRaVIAG3gvmr6rQh8t3cwKKwD1mVmM26AP+Y/Vfx8NQXYPHaal7X2nOeU4ZhF/mWK9hr2DnXUgrwaJYjfFgg2o7WGGHbfvJ6ax3KEtBvPkKSvk+p5wXAEtoD9k2GtnYe5fQN8lJ2nS4nqf+9D4+1jDwJ9eR9EiRCL7m3CzYBLwWAoERERERERL4hfwArm02RXSO03AAAAAElFTkSuQmCC"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .panel {
        background: white;
        border-radius: 0.75rem;
        box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        border: 1px solid #e5e7eb;
        padding: 1.5rem;
      }
      .btn-primary {
        padding: 0.5rem 1rem;
        background-color: #2563eb;
        color: white;
        border-radius: 0.5rem;
        font-weight: 500;
        transition: all 0.2s;
      }
      .btn-primary:hover {
        background-color: #1d4ed8;
      }
      .btn-secondary {
        padding: 0.5rem 1rem;
        background-color: #f3f4f6;
        color: #374151;
        border-radius: 0.5rem;
        font-weight: 500;
        transition: all 0.2s;
      }
      .btn-secondary:hover {
        background-color: #e5e7eb;
      }
      .btn-danger {
        padding: 0.5rem 1rem;
        background-color: #dc2626;
        color: white;
        border-radius: 0.5rem;
        font-weight: 500;
        transition: all 0.2s;
      }
      .btn-danger:hover {
        background-color: #b91c1c;
      }
      .tab {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
        font-weight: 500;
        border-radius: 0.5rem;
        transition: all 0.2s;
        cursor: pointer;
      }
      .tab-active {
        background-color: #2563eb;
        color: white;
      }
      .tab-inactive {
        color: #4b5563;
      }
      .tab-inactive:hover {
        background-color: #f3f4f6;
      }
      .visual-display {
        position: relative;
        overflow: hidden;
        border-radius: 0.75rem;
        border: 1px solid #e5e7eb;
        background: radial-gradient(circle at center, #f8fafc 0%, #e2e8f0 75%);
        transition:
          background 0.6s ease,
          transform 0.6s ease;
        min-height: 12rem;
      }
      @keyframes blinkPalette {
        0%,
        100% {
          background: radial-gradient(circle at center, #1d4ed8 0%, #1e293b 75%);
          transform: scale(1);
        }
        25% {
          background: radial-gradient(circle at center, #0ea5e9 0%, #0369a1 80%);
          transform: scale(1.03);
        }
        50% {
          background: radial-gradient(circle at center, #22d3ee 0%, #14b8a6 80%);
          transform: scale(0.98);
        }
        75% {
          background: radial-gradient(circle at center, #f97316 0%, #c2410c 80%);
          transform: scale(1.04);
        }
      }
      .blink-animation {
        animation: blinkPalette 1.4s infinite;
      }
      @keyframes undulatePalette {
        0% {
          background: radial-gradient(circle at 20% 20%, #4338ca 0%, #2563eb 70%);
        }
        33% {
          background: radial-gradient(circle at 80% 30%, #0891b2 0%, #0ea5e9 70%);
        }
        66% {
          background: radial-gradient(circle at 30% 80%, #a855f7 0%, #7c3aed 70%);
        }
        100% {
          background: radial-gradient(circle at 70% 80%, #f59e0b 0%, #ef4444 70%);
        }
      }
      .undulate-animation {
        animation: undulatePalette 10s infinite alternate;
      }
      .track-section {
        border-top: 1px solid #e5e7eb;
        padding-top: 1rem;
      }
      .track-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .track-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #f8fafc;
        border: 1px solid #e5e7eb;
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
      }
      .track-item h4 {
        font-size: 0.95rem;
        font-weight: 600;
        color: #1f2937;
      }
      .track-item p {
        font-size: 0.75rem;
        color: #6b7280;
        margin-top: 0.125rem;
      }
      .track-item button {
        font-size: 0.75rem;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        background-color: #fee2e2;
        color: #b91c1c;
        border: 1px solid #fecaca;
        transition:
          background 0.2s,
          color 0.2s;
      }
      .track-item button:hover {
        background-color: #fecaca;
        color: #7f1d1d;
      }
      .track-empty {
        font-size: 0.875rem;
        color: #6b7280;
        padding: 0.75rem 0.5rem;
      }
      .visual-layer-container {
        position: absolute;
        inset: 0;
        display: grid;
        pointer-events: none;
        z-index: 1;
      }
      .visual-layer {
        position: absolute;
        inset: 0;
        border-radius: inherit;
        mix-blend-mode: screen;
        opacity: 0.85;
        transition:
          transform 0.6s ease,
          opacity 0.6s ease;
        pointer-events: none;
      }
      .visual-status-text {
        position: relative;
        z-index: 5;
        font-size: 0.9rem;
        line-height: 1.4;
        color: #374151;
        text-shadow: 0 1px 3px rgba(15, 23, 42, 0.1);
      }
      .visual-status-text.active {
        color: #f8fafc;
        text-shadow: 0 4px 12px rgba(15, 23, 42, 0.45);
      }
      .stat-card {
        border-radius: 0.75rem;
        border: 1px solid #e5e7eb;
        background: #ffffff;
        padding: 1rem 1.25rem;
        box-shadow: 0 1px 2px rgba(15, 23, 42, 0.04);
      }
      .stat-label {
        font-size: 0.65rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: #94a3b8;
        margin-bottom: 0.35rem;
        display: block;
      }
      .stat-value {
        font-size: 1.15rem;
        font-weight: 600;
        color: #1f2937;
      }
      .stat-panel {
        border-radius: 0.75rem;
        border: 1px solid #e2e8f0;
        background: #ffffff;
        padding: 1.25rem;
        box-shadow: 0 1px 2px rgba(15, 23, 42, 0.04);
      }
      .stat-panel h3 {
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #94a3b8;
        margin-bottom: 0.75rem;
      }
      .stat-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }
      .stat-list li {
        display: flex;
        justify-content: space-between;
        font-size: 0.85rem;
        color: #475569;
      }
      .stat-list span {
        font-weight: 600;
        color: #111827;
      }
      .profile-summary {
        border-radius: 0.75rem;
        border: 1px solid #e2e8f0;
        background: #f8fafc;
        padding: 1.25rem;
        font-size: 0.9rem;
        color: #475569;
      }
      .toggle-group {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .toggle-option {
        display: flex;
        gap: 0.75rem;
        align-items: flex-start;
      }
      .toggle-option input[type='checkbox'] {
        margin-top: 0.3rem;
      }
      .toggle-option.disabled {
        opacity: 0.6;
      }
      .toggle-title {
        display: block;
        font-weight: 600;
        color: #1f2937;
        font-size: 0.9rem;
      }
      .toggle-desc {
        display: block;
        font-size: 0.8rem;
        color: #64748b;
        margin-top: 0.1rem;
      }
      .usage-scope-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-top: 1.25rem;
      }
      .usage-scope-tab {
        padding: 0.35rem 0.9rem;
        border-radius: 9999px;
        border: 1px solid #cbd5f5;
        background: #f8fafc;
        color: #1f2937;
        font-size: 0.75rem;
        font-weight: 600;
        transition: all 0.2s;
      }
      .usage-scope-tab:hover {
        background: #e0e7ff;
      }
      .usage-scope-tab-active {
        background: #2563eb;
        border-color: #2563eb;
        color: #ffffff;
      }
      .activity-panel {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .activity-tabs {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .activity-tab {
        padding: 0.35rem 0.9rem;
        border-radius: 9999px;
        border: 1px solid #cbd5f5;
        background: #f8fafc;
        color: #1f2937;
        font-size: 0.75rem;
        font-weight: 600;
        transition: all 0.2s;
      }
      .activity-tab:hover {
        background: #e0e7ff;
      }
      .activity-tab-active {
        background: #2563eb;
        border-color: #2563eb;
        color: #ffffff;
      }
      .activity-refresh {
        margin-left: auto;
        font-size: 0.75rem;
        border-radius: 9999px;
        border: 1px solid #e2e8f0;
        padding: 0.3rem 0.8rem;
        background: #ffffff;
        color: #1f2937;
      }
      .activity-refresh:hover {
        background: #f1f5f9;
      }
      .activity-note {
        font-size: 0.75rem;
        color: #64748b;
      }
      .activity-feed {
        border-radius: 0.75rem;
        border: 1px solid #e2e8f0;
        background: #ffffff;
        padding: 0.85rem;
        max-height: 18rem;
        overflow-y: auto;
      }
      .activity-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 0.65rem;
      }
      .activity-item {
        display: flex;
        flex-direction: column;
        gap: 0.15rem;
        font-size: 0.82rem;
        color: #1f2937;
      }
      .activity-item .activity-meta {
        font-size: 0.72rem;
        color: #94a3b8;
      }
      .activity-empty {
        font-size: 0.8rem;
        color: #94a3b8;
      }
      @media (prefers-reduced-motion: reduce) {
        .blink-animation,
        .undulate-animation {
          animation-duration: 0s;
          animation-iteration-count: 1;
        }
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <header class="bg-white border-b sticky top-0 z-50 shadow-sm">
      <div class="max-w-7xl mx-auto px-4 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div
              class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center text-white font-bold shadow"
            >
              B
            </div>
            <div>
              <h1 class="text-xl font-bold">BioSynCare Lab</h1>
              <p class="text-xs text-gray-500">Neurosensory Stimulation Dashboard</p>
            </div>
          </div>
          <div class="flex gap-2">
            <button id="btn-init" class="btn-primary text-sm">üéß Initialize</button>
            <button id="btn-stop" class="btn-danger text-sm hidden">‚èπ Stop</button>
          </div>
        </div>
      </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
      <div class="panel mb-6" id="identity-panel">
        <div class="flex flex-col gap-4 md:flex-row md:items-start md:justify-between">
          <div class="space-y-2">
            <h2 class="text-2xl font-bold">Session & Identity</h2>
            <p id="auth-status" class="text-sm text-gray-600">
              Checking authentication state...
            </p>
            <div class="flex flex-wrap items-center gap-2 text-sm">
              <span class="uppercase tracking-wide text-gray-400 text-xs"
                >Current identity</span
              >
              <span id="auth-identity" class="font-medium text-gray-800">‚Äî</span>
              <span
                id="auth-anonymous-badge"
                class="hidden rounded-full bg-slate-200 px-2 py-1 text-xs font-medium text-slate-600"
              >
                Anonymous session
              </span>
            </div>
          </div>
          <div class="flex items-start justify-end">
            <button id="btn-signout" class="btn-secondary text-sm hidden" type="button">
              ‚Ü© Sign out
            </button>
          </div>
        </div>
        <div id="auth-login-section" class="mt-5 space-y-4">
          <div class="space-y-3">
            <p class="text-xs font-semibold uppercase text-gray-400">Quick login</p>
            <div class="flex flex-wrap items-center gap-3">
              <button id="btn-login-google" class="btn-primary text-sm" type="button">
                ‚ú® Continue with Google
              </button>
              <button id="btn-login-github" class="btn-secondary text-sm" type="button">
                üêô Continue with GitHub
              </button>
            </div>
          </div>
          <div class="space-y-3 border-t border-slate-200 pt-4">
            <p class="text-xs font-semibold uppercase text-gray-400">Email access</p>
            <div class="grid gap-2 sm:grid-cols-2">
              <input
                id="auth-email"
                type="email"
                autocomplete="email"
                placeholder="you@example.com"
                class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
              />
              <input
                id="auth-password"
                type="password"
                autocomplete="current-password"
                placeholder="Password"
                class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
              />
            </div>
            <div class="flex flex-wrap items-center gap-3">
              <button id="btn-email-login" class="btn-primary text-sm" type="button">
                Login
              </button>
              <button id="btn-email-register" class="btn-secondary text-sm" type="button">
                Register
              </button>
            </div>
          </div>
          <p id="auth-feedback" class="text-xs text-red-500 hidden" role="status"></p>
        </div>
        <div class="mt-6">
          <div
            class="usage-scope-tabs"
            role="tablist"
            aria-label="Usage metrics scope selection"
            id="usage-scope-tabs"
          >
            <button
              type="button"
              class="usage-scope-tab"
              data-usage-scope="session"
              id="usage-scope-tab-session"
            >
              This session
            </button>
            <button
              type="button"
              class="usage-scope-tab usage-scope-tab-active"
              data-usage-scope="user"
              id="usage-scope-tab-user"
            >
              This user
            </button>
            <button
              type="button"
              class="usage-scope-tab"
              data-usage-scope="global"
              id="usage-scope-tab-global"
            >
              All users
            </button>
          </div>
          <p id="usage-scope-description" class="mt-2 text-xs text-gray-500">
            Showing lifetime activity for this user across recorded sessions.
          </p>
        </div>
        <div class="mt-6 grid gap-4 md:grid-cols-2 lg:grid-cols-4" id="auth-stat-cards">
          <div class="stat-card">
            <span class="stat-label">Audio initializations</span>
            <span id="stat-audio-inits" class="stat-value">0</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Audio tracks added</span>
            <span id="stat-audio-adds" class="stat-value">0</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Visual cues added</span>
            <span id="stat-visual-adds" class="stat-value">0</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Tracks stopped</span>
            <span id="stat-track-stops" class="stat-value">0</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Session time</span>
            <span id="stat-session-time" class="stat-value">00:00:00</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Neurostimulation time</span>
            <span id="stat-neuro-time" class="stat-value">00:00:00</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">First sign-in</span>
            <span id="stat-first-signin" class="stat-value text-sm">‚Äî</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Last sign-in</span>
            <span id="stat-last-signin" class="stat-value text-sm">‚Äî</span>
          </div>
        </div>
        <div class="mt-6 grid gap-6 md:grid-cols-2">
          <div class="stat-panel">
            <h3>Audio track exposure</h3>
            <ul id="stat-audio-duration-list" class="stat-list">
              <li>No audio tracks yet.</li>
            </ul>
          </div>
          <div class="stat-panel">
            <h3>Visual cue exposure</h3>
            <ul id="stat-visual-duration-list" class="stat-list">
              <li>No visual cues yet.</li>
            </ul>
          </div>
        </div>
        <div class="mt-6">
          <h3 class="text-xs font-semibold uppercase text-gray-400 mb-2">
            Self-reported profile
          </h3>
          <div id="stat-profile" class="profile-summary">
            No self-reported profile yet.
          </div>
        </div>
        <div class="mt-8 grid gap-6 lg:grid-cols-2">
          <div class="stat-panel">
            <h3>Data & Privacy</h3>
            <div class="toggle-group mt-3">
              <label class="toggle-option" id="toggle-collect-wrapper">
                <input type="checkbox" id="toggle-collect-data" checked />
                <div>
                  <span class="toggle-title">Collect usage statistics</span>
                  <span class="toggle-desc"
                    >Store personal metrics to resume sessions across devices.</span
                  >
                </div>
              </label>
              <label class="toggle-option" id="toggle-share-wrapper">
                <input type="checkbox" id="toggle-share-anonymized" checked />
                <div>
                  <span class="toggle-title">Share anonymized logs publicly</span>
                  <span class="toggle-desc"
                    >Let others see your activity with an anonymous label.</span
                  >
                </div>
              </label>
              <label class="toggle-option" id="toggle-community-wrapper">
                <input type="checkbox" id="toggle-include-community" checked />
                <div>
                  <span class="toggle-title">Contribute to community insights</span>
                  <span class="toggle-desc"
                    >Allow your anonymized data to be used in aggregate statistics.</span
                  >
                </div>
              </label>
            </div>
            <div class="mt-6 space-y-3 border-t border-slate-200 pt-4">
              <p class="text-xs font-semibold uppercase text-gray-400">Sensory engines</p>
              <div class="grid gap-3 md:grid-cols-3">
                <label class="text-sm font-medium text-gray-700">
                  <span class="block mb-1">Audio</span>
                  <select
                    id="engine-audio-select"
                    class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
                  ></select>
                  <span
                    id="engine-audio-status"
                    class="mt-1 block text-xs text-gray-500"
                  ></span>
                </label>
                <label class="text-sm font-medium text-gray-700">
                  <span class="block mb-1">Visual</span>
                  <select
                    id="engine-visual-select"
                    class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
                  ></select>
                  <span
                    id="engine-visual-status"
                    class="mt-1 block text-xs text-gray-500"
                  ></span>
                </label>
                <label class="text-sm font-medium text-gray-700">
                  <span class="block mb-1">Haptics</span>
                  <select
                    id="engine-haptics-select"
                    class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
                  ></select>
                  <span
                    id="engine-haptics-status"
                    class="mt-1 block text-xs text-gray-500"
                  ></span>
                </label>
              </div>
            </div>
          </div>
          <div class="stat-panel activity-panel">
            <h3>Your Activity Logs</h3>
            <div class="activity-tabs">
              <button
                id="tab-my-activity"
                class="activity-tab activity-tab-active"
                type="button"
              >
                My activity
              </button>
              <button id="tab-public-activity" class="activity-tab" type="button">
                Public view
              </button>
              <button id="btn-refresh-activity" class="activity-refresh" type="button">
                ‚ü≥ Refresh
              </button>
            </div>
            <p id="activity-public-note" class="activity-note">
              Public feed displays anonymized entries shared by you and the community.
            </p>
            <div id="activity-my-panel" class="activity-feed">
              <ul id="activity-my-list" class="activity-list">
                <li class="activity-empty">No activity logged yet.</li>
              </ul>
            </div>
            <div id="activity-public-panel" class="activity-feed hidden">
              <ul id="activity-public-list" class="activity-list">
                <li class="activity-empty">Public feed loading‚Ä¶</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="grid gap-6 lg:grid-cols-2">
        <div class="panel">
          <h2 class="text-2xl font-bold mb-4">Audio Controls</h2>
          <p id="status" class="text-gray-600 mb-4">Click Initialize to start</p>
          <div class="space-y-6">
            <div class="space-y-2">
              <div class="flex items-center justify-between gap-2">
                <label for="audio-menu" class="block text-sm font-medium text-gray-700"
                  >Audio feature</label
                >
                <span class="text-xs text-gray-400">Layer tracks to craft a session</span>
              </div>
              <div class="grid gap-3 sm:grid-cols-[1fr_auto]">
                <select
                  id="audio-menu"
                  class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
                >
                  <option value="sine">Pure sine ‚Ä¢ 440Hz</option>
                  <option value="binaural">Binaural beat ‚Ä¢ Alpha 10Hz</option>
                  <option value="monaural">Monaural beat ‚Ä¢ Theta 6Hz</option>
                  <option value="isochronic">Isochronic pulse ‚Ä¢ 12Hz breathing</option>
                  <option value="martigli">Martigli harmonics</option>
                  <option value="noise-white">Noise ‚Ä¢ White spectrum</option>
                  <option value="noise-pink">Noise ‚Ä¢ Pink spectrum</option>
                  <option value="noise-brown">Noise ‚Ä¢ Brown spectrum</option>
                </select>
                <button id="btn-add-audio" class="btn-primary">‚ûï Add track</button>
              </div>
              <p id="audio-description" class="text-xs text-gray-500 leading-relaxed">
                Pure sine tone at 440Hz for quick calibration and reference.
              </p>
            </div>
            <div class="flex flex-wrap gap-3">
              <button id="btn-stop-all-audio" class="btn-secondary text-sm">
                ‚èπ Stop all audio
              </button>
            </div>
            <div class="track-section">
              <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-semibold text-gray-700">Active audio tracks</h3>
                <span id="audio-track-count" class="text-xs font-medium text-gray-400"
                  >0 layers</span
                >
              </div>
              <div id="audio-active-empty" class="track-empty">
                No audio layers running. Add a track to begin.
              </div>
              <div id="audio-active-list" class="track-list"></div>
            </div>
          </div>
        </div>
        <div class="panel">
          <h2 class="text-2xl font-bold mb-4">Visual Controls</h2>
          <p class="text-gray-600 mb-4">
            Pair color entrainment with audio sessions or run standalone.
          </p>
          <div class="space-y-6">
            <div class="space-y-2">
              <div class="flex items-center justify-between gap-2">
                <label for="visual-menu" class="block text-sm font-medium text-gray-700"
                  >Visual feature</label
                >
                <span class="text-xs text-gray-400">Stack light cues</span>
              </div>
              <div class="grid gap-3 sm:grid-cols-[1fr_auto]">
                <select
                  id="visual-menu"
                  class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:outline-none focus:ring focus:ring-blue-200"
                >
                  <option value="blink">Blinking colors</option>
                  <option value="undulate">Undulating colors</option>
                </select>
                <button id="btn-add-visual" class="btn-primary">‚ûï Add visual</button>
              </div>
              <p id="visual-description" class="text-xs text-gray-500 leading-relaxed">
                High-contrast blinking palette for alert focus and breathing cadence.
              </p>
            </div>
            <div class="flex flex-wrap gap-3">
              <button id="btn-stop-all-visual" class="btn-secondary text-sm">
                ‚èπ Stop all visual
              </button>
            </div>
          </div>
          <div
            id="visual-display"
            class="visual-display mt-6 flex h-48 items-center justify-center px-4 text-center text-sm font-medium text-gray-600 transition-colors"
          >
            <div
              id="visual-layer-container"
              class="visual-layer-container"
              aria-hidden="true"
            ></div>
            <span
              id="visual-status-text"
              class="visual-status-text transition-colors duration-300"
              >Visual output appears here once started.</span
            >
          </div>
          <div class="track-section mt-6">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-sm font-semibold text-gray-700">Active visual layers</h3>
              <span id="visual-track-count" class="text-xs font-medium text-gray-400"
                >0 layers</span
              >
            </div>
            <div id="visual-active-empty" class="track-empty">
              No visual layers running. Add a cue to illuminate the panel.
            </div>
            <div id="visual-active-list" class="track-list"></div>
          </div>
        </div>
      </div>
    </main>

    <!-- System Diagnostics Widget (FAB: Floating Action Button) -->
    <div id="diag-fab" class="fixed bottom-4 left-4 z-50">
      <!-- Collapsed button -->
      <button
        id="diag-toggle"
        aria-expanded="false"
        aria-controls="diag-panel"
        class="shadow-lg rounded-full bg-neutral-900 text-white w-12 h-12 grid place-items-center hover:bg-neutral-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-neutral-400"
        title="Diagn√≥stico do sistema"
      >
        <span class="sr-only">Abrir diagn√≥stico do sistema</span>
        üîß
      </button>

      <!-- Expanded panel -->
      <div
        id="diag-panel"
        class="hidden mt-2 w-[380px] max-w-[90vw] max-h-[80vh] overflow-y-auto rounded-xl border bg-white shadow-xl"
        role="dialog"
        aria-label="Diagn√≥stico do sistema"
      >
        <div class="sticky top-0 bg-white p-3 border-b flex items-center gap-2 z-10">
          <div class="flex-1">
            <div class="text-sm font-semibold">Diagn√≥stico do Sistema</div>
            <div id="diag-mini-summary" class="text-[11px] text-neutral-500">
              Carregando‚Ä¶
            </div>
          </div>
          <button
            id="diag-close"
            class="text-neutral-500 hover:text-neutral-800 px-2 py-1 rounded"
            title="Fechar"
          >
            ‚úï
          </button>
        </div>

        <div class="p-3 space-y-3 text-xs text-neutral-700">
          <!-- System Health Summary Card -->
          <div
            id="health-summary-card"
            class="border-2 rounded-lg p-3 bg-gradient-to-br from-neutral-50 to-neutral-100"
          >
            <div class="flex items-center gap-2 mb-2">
              <div id="health-indicator" class="w-3 h-3 rounded-full bg-gray-400"></div>
              <div class="text-sm font-bold text-neutral-800">System Health</div>
            </div>
            <div class="grid grid-cols-1 gap-1.5 text-[11px]">
              <div class="flex justify-between items-center">
                <span class="text-neutral-600">Health:</span>
                <span id="health-status-text" class="font-semibold">--</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-neutral-600">Hardware:</span>
                <span id="health-hardware-text" class="font-medium">--</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-neutral-600">Software:</span>
                <span id="health-software-text" class="font-medium">--</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-neutral-600">Memory:</span>
                <span id="health-memory-text" class="font-medium">--</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-neutral-600">Network:</span>
                <span id="health-network-text" class="font-medium">--</span>
              </div>
            </div>
            <div
              id="health-issues-container"
              class="mt-2 pt-2 border-t border-neutral-300 hidden"
            >
              <div class="text-[10px] text-red-600 font-semibold mb-1">Issues:</div>
              <ul
                id="health-issues-list"
                class="text-[10px] text-red-600 space-y-0.5 list-disc list-inside"
              ></ul>
            </div>
          </div>

          <!-- Engines BSCLab -->
          <details class="border rounded-lg" open>
            <summary
              class="cursor-pointer p-2 bg-neutral-50 font-semibold text-xs hover:bg-neutral-100"
            >
              üéµüé® Engines BSCLab
            </summary>
            <div class="p-2 space-y-2 text-[11px]">
              <div class="flex justify-between">
                <span>Engine de √Åudio:</span>
                <span id="engine-audio-name" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Status √Åudio:</span>
                <span id="engine-audio-status" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Vers√£o √Åudio:</span>
                <span id="engine-audio-version" class="font-mono">--</span>
              </div>
              <div class="border-t pt-2 mt-2"></div>
              <div class="flex justify-between">
                <span>Engine Visual:</span>
                <span id="engine-visual-name" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Status Visual:</span>
                <span id="engine-visual-status" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Vers√£o Visual:</span>
                <span id="engine-visual-version" class="font-mono">--</span>
              </div>
              <div class="border-t pt-2 mt-2"></div>
              <div class="flex justify-between">
                <span>Engine Haptic:</span>
                <span id="engine-haptic-name" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Status Haptic:</span>
                <span id="engine-haptic-status" class="font-mono">--</span>
              </div>
            </div>
          </details>

          <!-- Performance & Active Tracks -->
          <details class="border rounded-lg" open>
            <summary
              class="cursor-pointer p-2 bg-neutral-50 font-semibold text-xs hover:bg-neutral-100"
            >
              ‚ö° Performance & Tracks
            </summary>
            <div class="p-2 space-y-2 text-[11px]">
              <div class="flex justify-between">
                <span>Active Audio Tracks:</span>
                <span id="perf-audio-tracks" class="font-mono font-semibold text-blue-600"
                  >--</span
                >
              </div>
              <div class="flex justify-between">
                <span>Active Visual Tracks:</span>
                <span
                  id="perf-visual-tracks"
                  class="font-mono font-semibold text-purple-600"
                  >--</span
                >
              </div>
              <div class="border-t pt-2 mt-2"></div>
              <div class="flex justify-between">
                <span>JS Heap Used:</span>
                <span id="perf-heap-used" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>JS Heap Limit:</span>
                <span id="perf-heap-limit" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Memory Usage:</span>
                <span id="perf-memory-usage" class="font-mono">--</span>
              </div>
              <div class="border-t pt-2 mt-2"></div>
              <div class="flex justify-between">
                <span>Page Load Time:</span>
                <span id="perf-page-load" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>DOM Interactive:</span>
                <span id="perf-dom-interactive" class="font-mono">--</span>
              </div>
            </div>
          </details>

          <!-- Audio Detalhado -->
          <details class="border rounded-lg" open>
            <summary
              class="cursor-pointer p-2 bg-neutral-50 font-semibold text-xs hover:bg-neutral-100"
            >
              üîä √Åudio Detalhado
            </summary>
            <div class="p-2 space-y-2 text-[11px]">
              <div class="flex justify-between">
                <span>Web Audio API:</span>
                <span id="detailed-audio-api" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Taxa de Amostragem:</span>
                <span id="detailed-sample-rate" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Bit Depth:</span>
                <span id="detailed-bit-depth" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Canais M√°ximos:</span>
                <span id="detailed-channels" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Estado do Contexto:</span>
                <span id="detailed-audio-state" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>√Åudio Tocando:</span>
                <span id="detailed-audio-playing" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Lat√™ncia Base:</span>
                <span id="detailed-base-latency" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Lat√™ncia Output:</span>
                <span id="detailed-output-latency" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Buffer Size (est):</span>
                <span id="detailed-buffer-size" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Fones de Ouvido:</span>
                <span id="detailed-headphones" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Dispositivos Entrada:</span>
                <span id="detailed-input-devices" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Dispositivos Sa√≠da:</span>
                <span id="detailed-output-devices" class="font-mono">--</span>
              </div>
            </div>
          </details>

          <!-- Display & Visual -->
          <details class="border rounded-lg" open>
            <summary
              class="cursor-pointer p-2 bg-neutral-50 font-semibold text-xs hover:bg-neutral-100"
            >
              üñ•Ô∏è Display & Visual
            </summary>
            <div class="p-2 space-y-2 text-[11px]">
              <div class="flex justify-between">
                <span>Resolu√ß√£o Tela:</span>
                <span id="detailed-screen-res" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>√Årea Dispon√≠vel:</span>
                <span id="detailed-avail-res" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Viewport:</span>
                <span id="detailed-viewport" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Aspect Ratio:</span>
                <span id="detailed-aspect-ratio" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Pixel Ratio:</span>
                <span id="detailed-pixel-ratio" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>DPI:</span>
                <span id="detailed-dpi" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Profundidade Cor:</span>
                <span id="detailed-color-depth" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>HDR:</span>
                <span id="detailed-hdr" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Orienta√ß√£o:</span>
                <span id="detailed-orientation" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Multi-Monitor:</span>
                <span id="detailed-multi-monitor" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Taxa Atualiza√ß√£o:</span>
                <span id="detailed-refresh-rate" class="font-mono">--</span>
              </div>
            </div>
          </details>

          <!-- Hardware & Sistema -->
          <details class="border rounded-lg">
            <summary
              class="cursor-pointer p-2 bg-neutral-50 font-semibold text-xs hover:bg-neutral-100"
            >
              üíª Hardware & Sistema
            </summary>
            <div class="p-2 space-y-2 text-[11px]">
              <div class="flex justify-between">
                <span>Dispositivo:</span>
                <span id="detailed-device-model" class="font-mono text-[10px]">--</span>
              </div>
              <div class="flex justify-between">
                <span>Sistema Operacional:</span>
                <span id="detailed-os" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Arquitetura:</span>
                <span id="detailed-arch" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Plataforma:</span>
                <span id="detailed-platform" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>CPU N√∫cleos:</span>
                <span id="detailed-cores" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>RAM Dispositivo:</span>
                <span id="detailed-device-memory" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>GPU:</span>
                <span id="detailed-gpu-model" class="font-mono text-[10px]">--</span>
              </div>
              <div class="flex justify-between">
                <span>GPU Score:</span>
                <span id="detailed-gpu-score" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>WebGL:</span>
                <span id="detailed-webgl" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Touch:</span>
                <span id="detailed-touch" class="font-mono">--</span>
              </div>
              <div class="border-t pt-2 mt-2"></div>
              <div class="flex justify-between">
                <span>Bateria:</span>
                <span id="detailed-battery-level" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Carregando:</span>
                <span id="detailed-battery-charging" class="font-mono">--</span>
              </div>
            </div>
          </details>

          <!-- Browser Info -->
          <details class="border rounded-lg">
            <summary
              class="cursor-pointer p-2 bg-neutral-50 font-semibold text-xs hover:bg-neutral-100"
            >
              üåê Navegador
            </summary>
            <div class="p-2 space-y-2 text-[11px]">
              <div class="flex justify-between">
                <span>Navegador:</span>
                <span id="detailed-browser-name" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Vers√£o:</span>
                <span id="detailed-browser-version" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Engine:</span>
                <span id="detailed-browser-engine" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Vendor:</span>
                <span id="detailed-browser-vendor" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Idioma:</span>
                <span id="detailed-language" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Online:</span>
                <span id="detailed-online" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Conex√£o:</span>
                <span id="detailed-connection" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Cookies:</span>
                <span id="detailed-cookies" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Storage:</span>
                <span id="detailed-storage" class="font-mono">--</span>
              </div>
              <div class="flex justify-between">
                <span>Do Not Track:</span>
                <span id="detailed-dnt" class="font-mono">--</span>
              </div>
            </div>
          </details>

          <!-- Report composer -->
          <div class="pt-1 border-t">
            <label for="diag-message" class="block text-[11px] text-neutral-500 mb-1"
              >Mensagem (opcional)</label
            >
            <textarea
              id="diag-message"
              rows="3"
              class="w-full border rounded-md p-2 text-xs resize-y focus:outline-none focus:ring-2 focus:ring-neutral-300"
              placeholder="Descreva o que aconteceu (ex.: oscila√ß√£o de luz, √°udio falhando, flicker, etc.)"
            ></textarea>
          </div>

          <!-- Actions -->
          <div class="flex flex-wrap gap-2">
            <button
              id="btn-send-report"
              class="inline-flex items-center gap-1 rounded-md bg-neutral-900 text-white px-3 py-1.5 hover:bg-neutral-800"
            >
              Enviar relat√≥rio
            </button>
            <button
              id="btn-copy-json"
              class="inline-flex items-center gap-1 rounded-md border px-3 py-1.5 hover:bg-neutral-100"
            >
              Copiar diagn√≥stico
            </button>
            <button
              id="btn-download-json"
              class="ml-auto inline-flex items-center gap-1 rounded-md border px-3 py-1.5 hover:bg-neutral-100"
              title="Baixar JSON com os dados do sistema"
            >
              Baixar JSON
            </button>
          </div>

          <div class="text-[10px] text-neutral-500">
            Os dados ficam no seu dispositivo (localStorage). Se um endpoint de relat√≥rio
            for configurado, tentaremos enviar por HTTPS.
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
